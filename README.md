# FairGAN: GANs-based Fairness-aware Learning for Recommendations with Implicit Feedback
## Abstract:
Ranking algorithms in recommender systems influence people to make decisions. Conventional ranking algorithms based on implicit feedback data aim to maximize the utility to users by capturing users’ preferences over items. However, these utility-focused algorithms tend to cause fairness issues that require careful consideration in online platforms. Existing fairness-focused studies does not explicitly consider the problem of lacking negative feedback in implicit feedback data, while previous utility-focused methods ignore the importance of fairness in recommendations. To fill this gap, we propose a Generative Adversarial Networks (GANs) based learning algorithm FairGAN mapping the exposure fairness issue to the problem of negative preferences in implicit feedback data. FairGAN does not explicitly treat unobserved interactions as negative, but instead, adopts a novel fairness-aware learning strategy to dynamically generate fairness signals. This optimizes the search direction to make FairGAN capable of searching the space of the optimal ranking that can fairly allocate exposure to individual items while preserving users’ utilities as high as possible.

## The structure of FairGAN:
![The structure of FairGAN](/assets/images/FairGAN.png "The structure of FairGAN")

<style type="text/css">
    img {
        width: 70%;
    }
</style>

## Introduction
---
An implementation of FairGAN, which consists of two GANs-based models, Ranker and Controller. The ranker tries to capture users' preferences from only observed interactions, while the controller captures the exposure distribution of items based on rankings that is derived from relevance scores generated by the generator of the ranker. Then the controller generates fairness signals to enforce the ranker to generate fair rankings from a fair searching space. There are two steps to run FairGAN model:

- **Processing Data**: Preparing and Storing processed data into disk for FairGAN algorithm
- **Fitting and Evaluating Model**: Fitting FairGAN algorithm on training set and Evaluating on test set

For a more detailed overview of ***FairGAN***, please checkout our paper published on **WWW'22** ([paper](https://dl.acm.org/doi/10.1145/3485447.3511958)).

## Installation
---
This implementation of ***FairGAN*** supports running on ***CPU*** and ***GPU*** and has been tested with:
- [Python 3.6 - 3.9](https://www.python.org/)
- [TensorFlow 2.5 - 2.8](https://www.tensorflow.org/)
- [TensorFlow Ranking 0.5](https://github.com/tensorflow/ranking#:~:text=README.md-,TensorFlow%20Ranking,%2C%20pairwise%2C%20and%20listwise%20losses.)
- [LensKit 0.13, 0.14](https://lenskit.org/)
- [Pandas 1.3, 1.4](https://pandas.pydata.org/)
- [Numpy 1.2, 1.3](https://numpy.org/)
- [SciPy 1.7, 1.8](https://scipy.org/)

It is recommended to install the package and its dependencies via [PyPi](https://pypi.org/):

    pip install tensorflow
    pip install tensorflow_ranking
    pip install lenskit
    pip install scipy
    pip install pandas
    pip install numpy 

## Quick Start
There are two steps to run this implementation, ***processing data*** and ***fitting and evaluating the algorithm***.

### **Step 1**:
Before fitting the algorithm, you will need to download and process the dataset first:

    python process.py --dataset=Amazon-toys-and-games

Datasets that can be passed to `--dataset`: 

- Amazon-toys-and-games 
- Amazon-beauty
- Amazon-office-products
- Amazon-digital-musics

The processed dataset will be stored into `./data` directory for fitting and evaluating FairGAN later. We use `LensKit` to split the dataset, 5 splits will be stored, each of which extracts `20%` of the rows for testing and leaves `80%` for training.

### **Step 2**:
Start to fit FairGAN using training set and evaluate the fitted model using test set:

    # fitting and evaluating FairGAN on fold 1 of Amazon toys and games dataset
    # the value of --fold can be 1, 2, 3, 4, 5

    python train.py --dataset=Amazon-toys-and-games --fold=1

## Citation

Please cite our work using the following BibText if you find it's helpful in your reasearch:

    @inproceedings{li2022fairgan,
        title={FairGAN: GANs-based Fairness-aware Learning for Recommendations with Implicit Feedback},
        author={Li, Jie and Ren, Yongli and Deng, Ke},
        booktitle={Proceedings of the ACM Web Conference 2022},
        pages={297--307},
        year={2022}
    }
